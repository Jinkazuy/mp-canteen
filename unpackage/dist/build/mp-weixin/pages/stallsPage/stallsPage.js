(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/stallsPage/stallsPage"],{"1d3b":function(t,o,e){"use strict";e.r(o);var n=e("f8f8"),s=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(o,t,function(){return n[t]})}(a);o["default"]=s.a},3344:function(t,o,e){"use strict";var n,s=function(){var t=this,o=t.$createElement;t._self._c},a=[];e.d(o,"b",function(){return s}),e.d(o,"c",function(){return a}),e.d(o,"a",function(){return n})},"3a96":function(t,o,e){"use strict";var n=e("e9a2"),s=e.n(n);s.a},beee:function(t,o,e){"use strict";e.r(o);var n=e("3344"),s=e("1d3b");for(var a in s)"default"!==a&&function(t){e.d(o,t,function(){return s[t]})}(a);e("3a96");var r,l=e("f0c5"),i=Object(l["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);o["default"]=i.exports},cb60:function(t,o,e){"use strict";(function(t){e("261b"),e("921b");n(e("66fd"));var o=n(e("beee"));function n(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("543d")["createPage"])},e9a2:function(t,o,e){},f8f8:function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=i(e("a34a")),s=e("2f62"),a=e("6f3c"),r=i(e("8434")),l=e("6a2f");function i(t){return t&&t.__esModule?t:{default:t}}function u(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{},n=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.forEach(function(o){c(t,o,e[o])})}return t}function c(t,o,e){return o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}function d(t,o,e,n,s,a,r){try{var l=t[a](r),i=l.value}catch(u){return void e(u)}l.done?o(i):Promise.resolve(i).then(n,s)}function f(t){return function(){var o=this,e=arguments;return new Promise(function(n,s){var a=t.apply(o,e);function r(t){d(a,n,s,r,l,"next",t)}function l(t){d(a,n,s,r,l,"throw",t)}r(void 0)})}}var h=function(){return e.e("components/layout/star").then(e.bind(null,"b926"))},g=function(){return e.e("components/stallsPage/goodsScrollSB").then(e.bind(null,"d888"))},C=function(){return e.e("components/stallsPage/goodscarBar").then(e.bind(null,"1a00"))},p=function(){return e.e("components/stallsPage/adsubSymbols").then(e.bind(null,"9087"))},b=function(){return e.e("components/stallsPage/evaluateListItem").then(e.bind(null,"13f4"))},m={data:function(){return{active:0,goodsInfoModshow:!1,goodsInfoModData:{},goodsInfoModCount:0,modelStyle:[],maskStyle:[],goodsCarModShow:!1,canteenID:-1,stallID:-1,goodsList:[],userGoodsCarDatas:[],userGoodsCarTotalCount:0,userGoodsCarTotalPrice:0}},onLoad:function(t){console.log("==========================="),console.log(t),this.canteenID=t.canteenID||-1,this.stallID=t.stallID||-1},onShow:function(){var o=f(n.default.mark(function o(){var e,s=this;return n.default.wrap(function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,(0,l.isLogin)();case 2:if(e=o.sent,e){o.next=6;break}return t.navigateTo({url:"../../pages/login/login"}),o.abrupt("return");case 6:this.getGoodsData(),setTimeout(function(){s.computeCanteenStallGoodsCarCount(s.store_userGoodsCarDatas),s.computeCanteenStallGoodsCarTotalPrice(s.store_userGoodsCarDatas),s.computeCanteenStallGoodsCarDatas(s.store_userGoodsCarDatas)},100);case 8:case"end":return o.stop()}},o,this)}));function e(){return o.apply(this,arguments)}return e}(),methods:u({tabOnChange:function(t){console.log(t)},showGoodsMod:function(t,o){console.log("被点击的商品的数据，做浮层=↓"),console.log(t),this.goodsInfoModData=t,this.goodsInfoModCount=o,this.goodsInfoModshow=!0},goodsInfoModshowOnClose:function(){this.goodsInfoModshow=!1,console.log("卡片关闭啦")},openGoodsCar:function(){!0===this.goodsCarModShow?this.goodsCarModShow=!1:this.goodsCarModShow=!0},goodsCarModClose:function(){this.goodsCarModShow=!1},clearGoodsCar:function(){var t=this;this.goodsCarModShow=!1,o&&clearTimeout(o);var o=setTimeout(function(){var o={canteenId:t.canteenID,stallId:t.stallID};t.clearUserGoodsCar(o)},100)},getGoodsData:function(){var o=f(n.default.mark(function o(){var e;return n.default.wrap(function(o){while(1)switch(o.prev=o.next){case 0:if(-1===this.canteenID){o.next=12;break}if(-1===this.stallID){o.next=9;break}return console.log("获取档口的食品列表"),o.next=5,(0,a.http_getGoodsList)(this.canteenID,this.stallID);case 5:e=o.sent,2===e?t.switchTab({url:"../../pages/index/index",complete:function(t){console.log(t)}}):1===e?(0,r.default)("获取数据失败，请返回首页刷新重试"):this.goodsList=e,o.next=10;break;case 9:t.switchTab({url:"../../pages/index/index",complete:function(t){console.log(t)}});case 10:o.next=13;break;case 12:t.switchTab({url:"../../pages/index/index",complete:function(t){console.log(t)}});case 13:case"end":return o.stop()}},o,this)}));function e(){return o.apply(this,arguments)}return e}(),computeCanteenStallGoodsCarCount:function(t){if(this.userGoodsCarTotalCount=0,t.length>0){for(var o=0;o<t.length;o++)if(t[o].canteenId==this.canteenID)for(var e=0;e<t[o].stalls.length;e++)if(t[o].stalls[e].stallsId==this.stallID)for(var n=0;n<t[o].stalls[e].goodsList.length;n++)this.userGoodsCarTotalCount+=t[o].stalls[e].goodsList[n].count;console.log("该食堂下、该档口的购物车  总数"),console.log(this.userGoodsCarTotalCount)}},computeCanteenStallGoodsCarTotalPrice:function(t){if(this.userGoodsCarTotalPrice=0,t.length>0){for(var o=0;o<t.length;o++)if(t[o].canteenId==this.canteenID)for(var e=0;e<t[o].stalls.length;e++)if(t[o].stalls[e].stallsId==this.stallID)for(var n=0;n<t[o].stalls[e].goodsList.length;n++)this.userGoodsCarTotalPrice+=t[o].stalls[e].goodsList[n].count*Number(t[o].stalls[e].goodsList[n].goodsInfo.price),this.userGoodsCarTotalPrice=Number(this.userGoodsCarTotalPrice.toFixed(2));console.log("该食堂下、该档口的购物车  总价格"),console.log(this.userGoodsCarTotalPrice)}},computeCanteenStallGoodsCarDatas:function(t){if(this.userGoodsCarDatas=[],t.length>0){for(var o=0;o<t.length;o++)if(t[o].canteenId==this.canteenID)for(var e=0;e<t[o].stalls.length;e++)if(t[o].stalls[e].stallsId==this.stallID)for(var n=0;n<t[o].stalls[e].goodsList.length;n++)t[o].stalls[e].goodsList[n].count>0&&this.userGoodsCarDatas.push(t[o].stalls[e].goodsList[n]);console.log("该食堂下、该档口的购物车 数据"),console.log(this.userGoodsCarDatas)}}},(0,s.mapMutations)({}),(0,s.mapActions)(["clearUserGoodsCar"])),components:{goodsScrollSB:g,star:h,goodsCar:C,adsubSymbols:p,evaluateListItem:b},computed:u({},(0,s.mapGetters)(["store_ttt","store_userGoodsCarDatas"])),watch:{userGoodsCarTotalCount:function(t){t<=0&&(this.goodsCarModShow=!1)},store_userGoodsCarDatas:{handler:function(t){this.computeCanteenStallGoodsCarCount(t),this.computeCanteenStallGoodsCarTotalPrice(t),this.computeCanteenStallGoodsCarDatas(t)},deep:!0}}};o.default=m}).call(this,e("543d")["default"])}},[["cb60","common/runtime","common/vendor"]]]);